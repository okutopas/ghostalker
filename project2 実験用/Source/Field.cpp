#include "Field.h"
#include "Player.h"
//#include "CsvReader.h"
#include <vector>


using namespace std;

vector<vector<int>> maps = {
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},

};

//vector<vector<int>> maps;

Field::Field()
{
	//char filename[60];
	//sprintf_s<60>(filename, "Data/stage%02d.csv", stage);
	////csvから読んで、mapsを作る
	//CsvReader* csv = new CsvReader(filename);
	//int lines = csv->GetLines();
	//maps.resize(lines);
	//for (int y = 0; y < lines;y++) {
	//	int cols = csv->GetColumns(y);
	//	maps[y].resize(cols);
	//	for (int x = 0;x < cols;x++) {
	//		int num = csv->GetInt(y, x);
	//		maps[y][x] = num;
	//	}
	//}
	//delete csv;

	hImage = LoadGraph("Data/image/floor.png");
	x = 0;
	y = 0;
	scrollX = 0;
	for (int y = 0; y < maps.size(); y++)
	{
		for (int x = 0; x < maps[y].size(); x++)
		{
			if (maps[y][x] == 2)
			{
				new Player(x * 64, y * 64 );
			}
		}
	}
}

Field::~Field()
{
}

void Field::Update()
{
	//scrollX += 1;  強制スクロールの場合
}

void Field::Draw()
{
	//(x, y, 0, 32, 64, 64, hImage, 1);
	for (int y = 0; y < maps.size(); y++)
	{
		for (int x = 0; x < maps[y].size(); x++)
		{
			if (maps[y][x] == 1)
			{
				DrawRectGraph(x * 64 - scrollX, y * 64 , 0, 0, 64, 64, hImage, 1);
			}
		}
	}
}

//int Field::HitCheck(int px, int py)
//{
//	return 0;
//}
//
//int Field::HitCheckRight(int px, int py)
//{
//	if (px < 0)
//	{
//		return 0;
//	}
//
//	int x = px / 64;
//	int y = py  / 64;
//	if (y >= maps.size())
//	{
//		return 0;
//	}
//	if (maps[y][x] == 1)
//	{
//		return px % 64 + 1;
//	}
//	return 0;
//}
//
//int Field::HitCheckLeft(int px, int py)
//{
//	if (px < 400)
//	{
//		return 0;
//	}
//	int x = px / 64;
//	int y = (py - 400) / 64;
//	if (y >= maps.size())
//	{
//		return 0;
//	}
//	if (maps[y][x] == 1)
//	{
//		return 64 - px % 64;
//	}
//	return 0;
//}
//
//int Field::HitCheckDown(int px, int py)
//{
//	if (py < 400)
//	{
//		return 0;
//	}
//	int x = px / 64;
//	int y = (py - 400) / 64;
//	if (y >= maps.size())
//	{
//		return 0;
//	}
//	if (maps[y][x] == 1)
//	{
//		return (py - 400) % 64 + 1;
//	}
//	return 0;
//}
//
//int Field::HitCheckUp(int px, int py)
//{
//	if (py < 400)
//	{
//		return 0;
//	}
//	int x = px / 64;
//	int y = (py - 400) / 64;
//	if (y >= maps.size())
//	{
//		return 0;
//	}
//	if (maps[y][x] == 1)
//	{
//		return 64 - (py - 400) % 64;
//	}
//	return 0;
//}

bool Field::Out0fMap(int px, int py)
{
	if (py > 400 + 64 * maps.size())
	{
		return true;
	}
	return false;
}
